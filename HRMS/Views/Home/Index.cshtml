@{
    ViewData["Title"] = "Dashboard";
    var userRoles = ViewBag.UserRoles as List<string> ?? new List<string>();
    var isSystemAdmin = ViewBag.IsSystemAdmin as bool? ?? false;
    var isHRAdmin = ViewBag.IsHRAdmin as bool? ?? false;
    var isLineManager = ViewBag.IsLineManager as bool? ?? false;
    var currentEmployee = ViewBag.CurrentEmployee as HRMS.Models.Employee;
}

<div style="margin-bottom: 2rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <div>
            <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Welcome, @(currentEmployee?.full_name ?? User.Identity?.Name ?? "User")!</h1>
            <p class="text-muted">HRMS Enterprise Dashboard</p>
        </div>
        @if (currentEmployee != null)
        {
            <a asp-controller="Employee" asp-action="Details" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-secondary">
                View My Profile
            </a>
        }
    </div>

    @if (userRoles.Any())
    {
        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1.5rem;">
            @foreach (var role in userRoles)
            {
                <span style="background: var(--color-primary-light); color: white; padding: 0.4rem 0.8rem; border-radius: var(--radius-sm); font-size: 0.85rem; font-weight: 500;">
                    @role
                </span>
            }
        </div>
    }

</div>

<!-- User Information Card -->
@if (currentEmployee != null)
{
    <div class="premium-card card-full-width" style="margin-bottom: 2rem; padding: 1.5rem;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
            <h3 style="font-size: 1.1rem; margin: 0; padding-bottom: 0.75rem; border-bottom: 1px solid var(--color-border); flex: 1;">My Information</h3>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem 2rem;">
            <div>
                <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;">Email</div>
                <div style="font-weight: 500; font-size: 0.95rem;">@currentEmployee.email</div>
            </div>
            @if (currentEmployee.phone != null)
            {
                <div>
                    <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;">Phone</div>
                    <div style="font-weight: 500; font-size: 0.95rem;">@currentEmployee.phone</div>
                </div>
            }
            @if (currentEmployee.department != null)
            {
                <div>
                    <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;">Department</div>
                    <div style="font-weight: 500; font-size: 0.95rem;">@currentEmployee.department.department_name</div>
                </div>
            }
            @if (currentEmployee.position != null)
            {
                <div>
                    <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;">Position</div>
                    <div style="font-weight: 500; font-size: 0.95rem;">@currentEmployee.position.position_title</div>
                </div>
            }
            @if (currentEmployee.profile_completion.HasValue)
            {
                <div>
                    <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-bottom: 0.25rem;">Profile Completion</div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-sm); overflow: hidden;">
                            <div style="width: @currentEmployee.profile_completion%; height: 100%; background: var(--color-primary);"></div>
                        </div>
                        <span style="font-weight: 600; font-size: 0.9rem;">@currentEmployee.profile_completion%</span>
                    </div>
                </div>
            }
        </div>
    </div>
}

<!-- Attendance & Shift Management -->
<div class="dashboard-grid">
    <!-- Attendance Management -->
    <div class="premium-card">
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </div>
            <h3 style="font-size: 1.1rem; margin: 0;">Attendance Management</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <a asp-controller="Attendance" asp-action="Record" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start; font-weight: 600;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="16"></line>
                    <line x1="8" y1="12" x2="16" y2="12"></line>
                </svg>
                Record Attendance (Clock In/Out)
            </a>
            @if (isSystemAdmin || isHRAdmin)
            {
                <a asp-controller="Attendance" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    View All Attendance Records
                </a>
            }
            else if (isLineManager)
            {
                <a asp-controller="Attendance" asp-action="Index" asp-route-myAttendance="true" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    View My Attendance Records
                </a>
                <a asp-controller="Attendance" asp-action="TeamAttendance" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    View Team Attendance Records
                </a>
                <a asp-controller="Attendance" asp-action="TeamSummary" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <line x1="12" y1="20" x2="12" y2="10"></line>
                        <line x1="18" y1="20" x2="18" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="16"></line>
                    </svg>
                    Team Attendance Summary (Per Employee)
                </a>
            }
            else
            {
                <a asp-controller="Attendance" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    View My Attendance Records
                </a>
            }
            @if (isSystemAdmin)
            {
                <button onclick="syncLeaveWithAttendance(this)" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start; width: 100%;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                    </svg>
                    Sync Leave with Attendance
                </button>
                <a asp-controller="Attendance" asp-action="Correction" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    Request Attendance Correction
                </a>
            }
            @if (!isSystemAdmin && !isHRAdmin)
            {
                <a asp-controller="Attendance" asp-action="Correction" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    Request Attendance Correction
                </a>
            }
        </div>
    </div>

    <!-- Shift Management -->
    <div class="premium-card">
        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
            </div>
            <h3 style="font-size: 1.1rem; margin: 0;">Shift Management</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
            <a asp-controller="ShiftManagement" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start; font-weight: 600;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                View Shift Management
            </a>
            @if (isSystemAdmin)
            {
                <a asp-controller="ShiftManagement" asp-action="CreateShiftType" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Create Shift Type
                </a>
            }
            @if (isHRAdmin)
            {
                <a asp-controller="ShiftManagement" asp-action="CreateRotationalShift" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Configure Rotational Shift
                </a>
            }
            @if (isSystemAdmin || isLineManager)
            {
                <a asp-controller="ShiftManagement" asp-action="AssignShift" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="8.5" cy="7" r="4"></circle>
                        <line x1="20" y1="8" x2="20" y2="14"></line>
                        <line x1="23" y1="11" x2="17" y2="11"></line>
                    </svg>
                    Assign Shift to Employee/Department
                </a>
            }
            @if (isSystemAdmin)
            {
                <a asp-controller="ShiftManagement" asp-action="ManageEmployeeShifts" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    Manage Individual Employee Shifts
                </a>
            }
        </div>
    </div>
</div>

@if (isSystemAdmin)
{
    <script>
        async function syncLeaveWithAttendance() {
            if (!confirm('This will sync all approved leave requests with the attendance system and mark assigned shifts during leave periods as "on leave". Continue?')) {
                return;
            }
            
            const button = event.target.closest('button');
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> Syncing...';
            
            try {
                const response = await fetch('@Url.Action("SyncLeaveWithAttendance", "Attendance")', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    alert(data.message || 'Sync completed successfully!');
                    // Optionally reload the page to show updated data
                    // location.reload();
                } else {
                    alert('Error: ' + (data.message || 'Failed to sync leave with attendance'));
                }
            } catch (error) {
                console.error('Error syncing leave:', error);
                alert('An error occurred while syncing. Please try again.');
            } finally {
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }
    </script>
}

@if (isSystemAdmin)
{
    <!-- System Admin Dashboard -->
    <div style="margin-bottom: 2rem;">
        <h2 style="font-size: 1.5rem; margin-bottom: 1rem; color: var(--color-primary);">System Administrator Dashboard</h2>
        
        <div class="dashboard-grid">
            <!-- Department Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Department Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Department" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                        </svg>
                        Manage Departments
                    </a>
                    <a asp-controller="Department" asp-action="Create" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Create New Department
                    </a>
                    <a asp-controller="Department" asp-action="AssignToDepartment" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                        Assign People to Departments
                    </a>
                    <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                        Create departments and assign HR Admins, System Admins, Employees, and Line Managers to departments.
                    </small>
                </div>
            </div>

            <!-- Organizational Hierarchy -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <path d="M20 8v6M23 11h-6"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Organizational Hierarchy</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Component5" asp-action="Hierarchy" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <path d="M20 8v6M23 11h-6"></path>
                        </svg>
                        View & Manage Hierarchy
                    </a>
                    <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                        View the entire organizational structure and reassign employees to departments or managers.
                    </small>
                </div>
            </div>

            <!-- Employee Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Employee Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Employee" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        View All Employees (All Departments)
                    </a>
                    @if (currentEmployee != null)
                    {
                        <a asp-controller="Employee" asp-action="Details" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            My Profile
                        </a>
                    }
                </div>
            </div>

            <!-- Account Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Account Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Account" asp-action="CreateEmployeeAccount" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        Create Account for New Employee
                    </a>
                    <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                        Create accounts for new employees with email, password, role, and profile information.
                    </small>
                </div>
            </div>
        </div>
    </div>
}

@if (isHRAdmin)
{
    <!-- HR Admin Dashboard -->
    <div style="margin-bottom: 2rem;">
        <h2 style="font-size: 1.5rem; margin-bottom: 1rem; color: var(--color-primary);">HR Administrator Dashboard</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
            <!-- Analytics & Reports -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <line x1="18" y1="20" x2="18" y2="10"></line>
                            <line x1="12" y1="20" x2="12" y2="4"></line>
                            <line x1="6" y1="20" x2="6" y2="14"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Analytics & Reports</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Component5" asp-action="Analytics" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="18" y1="20" x2="18" y2="10"></line>
                            <line x1="12" y1="20" x2="12" y2="4"></line>
                            <line x1="6" y1="20" x2="6" y2="14"></line>
                        </svg>
                        View Analytics Dashboard
                    </a>
                    <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                        Generate department statistics, compliance reports, and diversity reports.
                    </small>
                </div>
            </div>

            <!-- Employee Profile Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Employee Profile Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Employee" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start; font-weight: 600;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        View All Employee Profiles
                    </a>
                    <a asp-controller="Employee" asp-action="ProfileCompleteness" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                        Manage Profile Completeness
                    </a>
                    @if (currentEmployee != null)
                    {
                        <a asp-controller="Employee" asp-action="Details" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            My Profile
                        </a>
                        <a asp-controller="Employee" asp-action="Edit" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Edit My Profile (Full Access)
                        </a>
                    }
                </div>
            </div>

            <!-- Contract Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Contract Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Contract" asp-action="Create" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Create Employment Contract
                    </a>
                    <a asp-controller="Contract" asp-action="Index" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        View All Contracts
                    </a>
                    <a asp-controller="Contract" asp-action="ExpiringSoon" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        Contracts Expiring Soon
                    </a>
                </div>
            </div>

            <!-- Mission Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Mission Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Mission" asp-action="Create" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Assign Mission to Employee
                    </a>
                    <p style="color: var(--color-text-secondary); font-size: 0.85rem; margin: 0;">
                        Create and assign new missions to employees. Assigned missions will require manager approval.
                    </p>
                </div>
            </div>

            <!-- Leave Administration -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Leave Administration</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="LeaveType" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        Manage Leave Types
                    </a>
                    <a asp-controller="LeavePolicy" asp-action="Index" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        Configure Leave Policies
                    </a>
                    <a asp-controller="LeaveEntitlement" asp-action="Index" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="1" x2="12" y2="23"></line>
                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                        </svg>
                        Adjust Leave Entitlements
                    </a>
                    <a asp-controller="LeaveOverride" asp-action="Index" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Override Leave Decisions
                    </a>
                    <a asp-controller="SpecialLeave" asp-action="Index" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                        </svg>
                        Manage Special Leave Requests
                    </a>
                </div>
            </div>

        </div>
    </div>
}

@if (isLineManager)
{
    <!-- Line Manager Dashboard -->
    <div style="margin-bottom: 2rem;">
        <h2 style="font-size: 1.5rem; margin-bottom: 1rem; color: var(--color-primary);">Line Manager Dashboard</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
            <!-- Notifications -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Notifications</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Component5" asp-action="MyNotifications" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        View My Notifications
                    </a>
                    <a asp-controller="Component5" asp-action="SendNotification" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                        Send Notification to Team
                    </a>
                    <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                        Send customized notifications to your team members.
                    </small>
                </div>
            </div>

            <!-- My Department -->
            @if (currentEmployee != null && currentEmployee.department_id.HasValue)
            {
                <div class="premium-card">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="9" y1="3" x2="9" y2="21"></line>
                                <line x1="3" y1="9" x2="21" y2="9"></line>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.1rem; margin: 0;">My Department</h3>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <a asp-controller="Department" asp-action="ViewMembers" asp-route-departmentId="@currentEmployee.department_id" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            View Department Members
                        </a>
                        <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                            View all people working in @(currentEmployee.department?.department_name ?? "your department").
                        </small>
                    </div>
                </div>
            }

            <!-- Team Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Team Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Employee" asp-action="MyTeam" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        View My Team Details
                    </a>
                    @if (currentEmployee != null)
                    {
                        <a asp-controller="Employee" asp-action="Details" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            My Profile
                        </a>
                    }
                </div>
            </div>

            <!-- Employee Profiles -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">View All Employee Profiles</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Employee" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start; font-weight: 600;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        View All Employee Profiles
                    </a>
                    <p style="color: var(--color-text-secondary); font-size: 0.85rem; margin: 0;">
                        As a Line Manager, you can view full employee profiles of all employees in the organization, not just your team members.
                    </p>
                </div>
            </div>

            <!-- Assign Employees -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Team Assignment</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Employee" asp-action="AssignToTeam" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                        Assign Employee to My Team
                    </a>
                    <p style="color: var(--color-text-secondary); font-size: 0.85rem; margin: 0;">
                        Add employees to your team by assigning them as direct reports.
                    </p>
                </div>
            </div>

            <!-- Mission Approvals -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Mission Approvals</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Mission" asp-action="Manager" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        Review Mission Approvals
                    </a>
                    <p style="color: var(--color-text-secondary); font-size: 0.85rem; margin: 0;">
                        Approve or reject mission requests from your team members.
                    </p>
                </div>
            </div>

            <!-- Leave Approvals -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Team Leave Approvals</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="LeaveApproval" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start; font-weight: 600;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <polyline points="9 11 12 14 22 4"></polyline>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                        </svg>
                        Review Pending Leave Requests
                    </a>
                    <p style="color: var(--color-text-secondary); font-size: 0.85rem; margin: 0;">
                        Approve, reject, or flag irregular leave patterns from your team.
                    </p>
                </div>
            </div>

        </div>
    </div>
}

@if (!isSystemAdmin && !isHRAdmin && !isLineManager)
{
    <!-- Regular Employee Dashboard -->
    <div style="margin-bottom: 2rem;">
        <h2 style="font-size: 1.5rem; margin-bottom: 1rem; color: var(--color-primary);">Employee Dashboard</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
            <!-- Notifications -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">My Notifications</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Component5" asp-action="MyNotifications" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        View All Notifications
                    </a>
                    <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                        View notifications for contract expirations, leave approvals, shift reassignments, and mission updates.
                    </small>
                </div>
            </div>

            <!-- My Profile -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">My Profile</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    @if (currentEmployee != null)
                    {
                        <a asp-controller="Employee" asp-action="Details" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            View My Profile
                        </a>
                        <a asp-controller="Employee" asp-action="Edit" asp-route-id="@currentEmployee.employee_id" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Update Personal Details & Emergency Contacts
                        </a>
                    }
                </div>
            </div>

            <!-- My Department -->
            @if (currentEmployee != null && currentEmployee.department_id.HasValue)
            {
                <div class="premium-card">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="9" y1="3" x2="9" y2="21"></line>
                                <line x1="3" y1="9" x2="21" y2="9"></line>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.1rem; margin: 0;">My Department</h3>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <a asp-controller="Department" asp-action="ViewMembers" asp-route-departmentId="@currentEmployee.department_id" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            View Department Members
                        </a>
                        <small style="color: var(--color-text-secondary); font-size: 0.85rem; margin-top: 0.5rem; display: block;">
                            View all people working in @(currentEmployee.department?.department_name ?? "your department") including employees, managers, HR Admins, and System Admins.
                        </small>
                    </div>
                </div>
            }

            <!-- My Team -->
            @if (currentEmployee != null && currentEmployee.manager_id.HasValue)
            {
                <div class="premium-card">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                        <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                        </div>
                        <h3 style="font-size: 1.1rem; margin: 0;">My Team</h3>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <a asp-controller="Employee" asp-action="MyTeam" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            View My Team
                        </a>
                        <p style="color: var(--color-text-secondary); font-size: 0.85rem; margin: 0;">
                            View your team members who share the same manager.
                        </p>
                    </div>
                </div>
            }

            <!-- Contracts -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">My Contracts</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Contract" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        View My Contracts
                    </a>
                </div>
            </div>

            <!-- Missions -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">My Missions</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="Mission" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        View My Missions
                    </a>
                </div>
            </div>

            <!-- Leave Management -->
            <div class="premium-card">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                    <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <h3 style="font-size: 1.1rem; margin: 0;">Leave Management</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <a asp-controller="LeaveRequest" asp-action="Index" class="btn-premium btn-primary" style="text-align: left; justify-content: flex-start; font-weight: 600;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                        </svg>
                        My Leave Requests
                    </a>
                    <a asp-controller="LeaveRequest" asp-action="Create" class="btn-premium btn-success" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Submit New Leave Request
                    </a>
                    <a asp-controller="LeaveRequest" asp-action="History" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <polyline points="1 4 1 10 7 10"></polyline>
                            <polyline points="23 20 23 14 17 14"></polyline>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                        </svg>
                        View Leave History
                    </a>
                    <a asp-controller="LeaveRequest" asp-action="Balance" class="btn-premium btn-secondary" style="text-align: left; justify-content: flex-start;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <line x1="12" y1="1" x2="12" y2="23"></line>
                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                        </svg>
                        View Leave Balance
                    </a>
                </div>
            </div>
        </div>
    </div>
}

@if (isSystemAdmin)
{
    <script>
        async function syncLeaveWithAttendance(button) {
            if (!confirm('This will sync all approved leave requests with the attendance system and mark assigned shifts during leave periods as "on leave". Continue?')) {
                return;
            }
            
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> Syncing...';
            
            try {
                const response = await fetch('@Url.Action("SyncLeaveWithAttendance", "Attendance")', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                // Check if response is OK (status 200-299)
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('Server error:', response.status, errorText);
                    alert('Server error: ' + response.status + '. ' + (errorText || 'Please check the server logs for details.'));
                    return;
                }
                
                // Try to parse JSON response
                let data;
                try {
                    data = await response.json();
                } catch (parseError) {
                    console.error('JSON parse error:', parseError);
                    const text = await response.text();
                    alert('Invalid response from server. The server may have returned an error page. Please check the console for details.');
                    return;
                }
                
                if (data.success) {
                    alert(data.message || 'Sync completed successfully!');
                } else {
                    alert('Error: ' + (data.message || 'Failed to sync leave with attendance'));
                }
            } catch (error) {
                console.error('Error syncing leave:', error);
                
                // Provide more specific error messages
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    alert('Network error: Could not connect to the server. Please check your internet connection and try again.');
                } else if (error.message) {
                    alert('Error: ' + error.message);
                } else {
                    alert('An error occurred while syncing. Please try again. Check the browser console for details.');
                }
            } finally {
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }
    </script>
}
